<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      rel="stylesheet"
      href="https://pchaganti.github.io/assets/css/bookshelf.main.css"
    />
    <link
      rel="stylesheet"
      href="https://pchaganti.github.io/assets/css/bookshelf.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Display:ital,wght@0,100..900;1,100..900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <main>
      <h1 id="my-bookshelf">pchaganti | biblio</h1>
      <h4 style="font-style: italic">
        A man ought to read just as inclination leads him; for what he reads as
        a task will do him little good - Samuel Johnson, 1742
      </h4>
      <div id="books-container"></div>
      <br />
      <script>
        async function loadBooks() {
          const years = ["2024", "2023"]; // Add all years
          const container = document.getElementById("books-container");

          for (const year of years) {
            const yearSection = document.createElement("div");
            yearSection.style.marginTop = "32px";

            const yearHeader = document.createElement("h2");
            yearHeader.className = "yearRead";
            yearHeader.textContent = year;
            yearSection.appendChild(yearHeader);

            try {
              const response = await fetch(`books/${year}.html`);
              const html = await response.text();
              const div = document.createElement("div");
              div.innerHTML = html;
              yearSection.appendChild(div);
              yearSection.appendChild(document.createElement("hr"));
              container.appendChild(yearSection);
            } catch (error) {
              console.error(`Error loading books for ${year}:`, error);
            }
          }
        }

        document.addEventListener("DOMContentLoaded", loadBooks);

        function getRandomInt(min, max) {
          min = Math.ceil(min);
          max = Math.floor(max);
          return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function randomChoice(array) {
          return array[Math.floor(Math.random() * array.length)];
        }

        let spines = Object.values(document.getElementsByClassName("spine"));
        let covers = Object.values(document.getElementsByClassName("cover"));
        let tops = Object.values(document.getElementsByClassName("top"));

        let availablePatterns = ["argyle", "tartan", "pyramid", "stairs"]; // we could probably get these programatically
        let availableColours = [
          "maroon",
          "darkgreen",
          "darkolivegreen",
          "brown",
          "saddlebrown",
          "sienna",
          "midnightblue",
        ];

        // assign a random height, pattern and colour to each book
        spines.map(function (s, i) {
          let randomHeight = getRandomInt(220, 290);
          s.style.height = `${randomHeight}px`;
          s.style.top = `${280 - randomHeight}px`;

          let randomPattern = randomChoice(availablePatterns);
          s.style.backgroundImage = `var(--spine-${randomPattern})`;

          let randomColor = randomChoice(availableColours);
          s.style.backgroundColor = randomColor;

          covers[i].style.height = `${randomHeight}px`;
          covers[i].style.top = `${280 - randomHeight}px`;

          tops[i].style.top = `${280 - randomHeight}px`;
        });
      </script>
    </main>
    <br /><br /><br />
  </body>
</html>
